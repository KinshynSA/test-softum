!function(){"use strict";function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var t=function(){function t(e){var r=e.childs;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.createPopup(r),this.handleClicks()}var r,a;return r=t,(a=[{key:"handleClicks",value:function(){var e=this;this.container.addEventListener("click",(function(t){if(t.target.closest(".popup-click_item")){var r=t.target.closest(".popup-click_item");({remove:function(){this.removePopup(r)}})[r.getAttribute("action")].call(e)}}))}},{key:"removePopup",value:function(e){this.container.remove(),document.body.style.overflow=""}},{key:"createPopup",value:function(e){if(this.container=document.createElement("div"),this.container.classList="popup_container",this.container.innerHTML='\n            <div class="popup_background popup-click_item" action="remove"></div>\n            <div class="popup_content">\n                <div class="popup"></div>\n            </div>\n        ',e){var t=this.container.querySelector(".popup");e.forEach((function(e){return t.append(e)}))}document.body.style.overflow="hidden",document.body.append(this.container)}}])&&e(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),t}();function r(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r="",a=e;a>0;--a)r+=t[Math.floor(Math.random()*t.length)];return r}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cardsBlock=document.getElementById("cardsBlock"),this.cardsBodyInner=this.cardsBlock.querySelector(".cards_body_inner"),this.cards=[],this.fillFlag=!1,this.loadSavedCards(),this.clearDeletedCards(),this.fillCardsBlockToScroll=this.fillCardsBlockToScroll(),this.handleClicks(),this.handleScrolls()}var l,c;return l=e,c=[{key:"loadSavedCards",value:function(){var e=this;localStorage.getItem("cards")&&(this.cards=JSON.parse(localStorage.getItem("cards")),this.cards.forEach((function(t){return e.createCard(t)})))}},{key:"clearDeletedCards",value:function(){localStorage.setItem("deletedCards",JSON.stringify([]))}},{key:"compareSizes",value:function(){var e,t=(e=this.cardsBlock.querySelectorAll(".card"),function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reduce((function(e,t){return e+t.offsetWidth}),-16);this.cardsBlock.querySelector(".cards_body").clientWidth>t?this.cardsBodyInner.classList.remove("filled"):this.cardsBodyInner.classList.add("filled")}},{key:"handleScrolls",value:function(){var e=this;document.addEventListener("scroll",(function(t){e.fillFlag&&e.fillCardsBlockToScroll()})),this.cardsBodyInner.addEventListener("scroll",(function(t){e.fillFlag&&e.fillCardsBlockToScroll()}))}},{key:"handleClicks",value:function(){var e=this;this.cardsBlock.addEventListener("click",(function(r){if(r.target.closest(".click_item")){var a=r.target.closest(".click_item"),n=a.getAttribute("action");"fill"!==n&&(e.fillFlag=!1,e.cardsBlock.querySelector(".cards_header_button-fill").classList.remove("button-stuck")),{add:e.addCard,remove:e.removeCard,fill:function(){this.fillFlag=!this.fillFlag,this.fillFlag&&this.fillCardsBlock(),a.classList.toggle("button-stuck")},clear:function(){var e=this;this.cards.forEach((function(t){return e.saveDeletedCard(t)})),this.cards=[this.cards[0]],this.cardsBlock.querySelectorAll(".card").forEach((function(e,t){t&&e.remove()})),this.cardsBodyInner.classList.remove("filled"),this.saveCards()},reestablish:function(){var e=a.getAttribute("id");this.reestablishDeletedCard(a,e)},history:function(){var e=JSON.parse(localStorage.getItem("deletedCards")),r=[];if(e.length)e.forEach((function(e){var t=document.createElement("div");t.classList="card-modal",t.innerHTML='\n                                <div class="card-modal_title">'.concat(e.title,'</div>\n                                <div class="card-modal_button button click_item" action="reestablish" id="').concat(e.id,'">Восстановить</div>\n                            '),r.push(t)})),new t({childs:r});else{var a=document.createElement("div");a.classList="card-modal_content",a.textContent="Удаленных карточек нет",new t({childs:[a]})}},deleteThis:function(){var e=this,t=a.closest(".card"),r=+t.dataset.id;t.remove(),this.cards=this.cards.filter((function(t){if(t.id!==r)return!0;e.saveDeletedCard(t)})),this.saveCards()},openModal:function(){var e,r=+a.closest(".card").dataset.id;this.cards.forEach((function(t){t.id===r&&(e=t.modalText)}));var n=document.createElement("div");n.classList="card-modal_content",n.textContent="Случайный контент: ".concat(e),new t({childs:[n]})}}[n].call(e)}}))}},{key:"fillCardsBlock",value:function(){var e=this.cardsBodyInner.querySelectorAll(".card");e.length||this.addCard();var t=(e=this.cardsBodyInner.querySelectorAll(".card"))[e.length-1];document.documentElement.clientWidth>768?t.getBoundingClientRect().top<document.documentElement.clientHeight?(this.addCard(),this.fillCardsBlock()):this.removeCard(!1):t.getBoundingClientRect().left<document.documentElement.clientWidth&&(this.addCard(),this.fillCardsBlock())}},{key:"addCard",value:function(){var e,t,a,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=o.id,l=o.title,c=o.text,s=o.modalText,d={id:i=null!==(e=i)&&void 0!==e?e:Date.now(),title:l=null!==(t=l)&&void 0!==t?t:r(Math.floor(20*Math.random())+1),text:c=null!==(a=c)&&void 0!==a?a:r(Math.floor(20*Math.random())+1),modalText:s=null!==(n=s)&&void 0!==n?n:r(Math.floor(20*Math.random())+1)};this.cards.push(d),this.createCard(d),this.saveCards()}},{key:"createCard",value:function(e){var t=document.createElement("div");t.classList="card",t.dataset.id=e.id,t.innerHTML='\n            <div class="card_inner">\n                <div class="card_close click_item" action="deleteThis"></div>\n                <h3 class="card_title">'.concat(e.title,"</h3>\n                <p>").concat(e.text,'</p>\n                <button class="button card_button click_item" action="openModal">Modal</button>\n            </div>\n        '),this.cardsBodyInner.append(t),this.compareSizes()}},{key:"removeCard",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.cards.pop(),r=this.cardsBlock.querySelectorAll(".card");r[r.length-1].remove(),this.saveCards(),e&&this.saveDeletedCard(t)}},{key:"saveCards",value:function(){localStorage.setItem("cards",JSON.stringify(this.cards))}},{key:"saveDeletedCard",value:function(e){var t=JSON.parse(localStorage.getItem("deletedCards"));t.push(e),localStorage.setItem("deletedCards",JSON.stringify(t))}},{key:"fillCardsBlockToScroll",value:function(){var e=this,t=0,r=document.documentElement.clientWidth<=768;return function(){r?e.fillCardsBlock():window.pageYOffset>t&&(e.fillCardsBlock(),t=window.pageYOffset)}}},{key:"reestablishDeletedCard",value:function(e,t){var r,o=JSON.parse(localStorage.getItem("deletedCards")),i=o.findIndex((function(e){return e.id===t}));r=o[i],o.splice(i,1),localStorage.setItem("deletedCards",JSON.stringify(o)),addCard(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r));var l=e.closest(".popup");e.closest(".card-modal").remove(),l.querySelectorAll(".card-modal").length||this.removePopup(l)}}],c&&i(l.prototype,c),Object.defineProperty(l,"prototype",{writable:!1}),e}();new l}();
//# sourceMappingURL=scripts.32785b89486e1a078595.js.map